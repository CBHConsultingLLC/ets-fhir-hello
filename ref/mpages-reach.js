function renderMPagesView(a){var b=null;try{b=MP_Util.CreateTimer("ENG:MPG.MPageReachView - renderMPagesView",a);var c=null;return parseMPageSettingsJSON(),populateMPageLocale(),c=createViewObject(a),MPageView.prototype.isPrototypeOf(c)?(c.initializeMPageView(),c.loadViewSettings(),c.initializeComponents(),c.renderView(),c.postProcessing(),c):null}catch(a){throw b&&(b.Abort(),b=null),logger.logJSError(a,null,"mpages-reach.js","renderMPagesView"),a}finally{b&&b.Stop()}}var ReachSummaryMPage=function(){logger.logMessage("Rendering Reach Summary MPages View"),this.setCategoryMean("MP_REACH_V5"),this.setName(i18n.REACH_SUMMARY),this.m_xrPrintFlag=!1,this.m_isWebEnabled=!0};ReachSummaryMPage.prototype=new MPageView,ReachSummaryMPage.prototype.constructor=MPageView,ReachSummaryMPage.prototype.getXRPrintFlag=function(){return this.m_xrPrintFlag},ReachSummaryMPage.prototype.setXRPrintFlag=function(a){this.m_xrPrintFlag=a},ReachSummaryMPage.prototype.loadFilterMappings=function(){MPageView.prototype.loadFilterMappings.call(this,null),this.addFilterMappingObject("XR_PRINTING",{setFunction:this.setXRPrintFlag,type:"Boolean",field:"FREETEXT_DESC"})},ReachSummaryMPage.prototype.initializeMPageView=function(){var a=null,b=null,c="MP_GET_PATIENT_DEMO",d=[],e=null,f=[],g=null,h=this;try{this.loadFilterMappings(),this.setCapTimerName("CAP:MPG MPages Reach Module"),this.setSubTimerName(this.getCategoryMean()),this.createMPageTimerObject(),this.setCriterion(createPageCriterion(this.getCategoryMean())),$(window).resize(function(){g&&clearTimeout(g),g=setTimeout(function(){return CERN_Browser.validateWindowResize()?void h.resizeView():null},100)})}catch(a){throw logger.logJSError(a,null,"mpages-reach.js","initializeMPageView"),a}a=this.getCriterion(),b=a.getPatientInfo();var i=b.getName(),j=b.getSex(),k=j?b.getSex().display:"--";d.push("^MINE^",a.person_id+".0",a.encntr_id+".0"),e=new MP_Core.ScriptRequest(null,"ENG:MPG.REACH_DEMO_BANNER.01 - retrieve patient demo info"),e.setProgramName(c),e.setName("GetReachDemoData"),e.setParameters(d),e.setAsync(!0),f.push('<div id="reachDemo" class="demo-main">','<h1 id="demoName" class="demo-head">',"</h1>",'<ul class="demo-itms">',"<li><span>DOB: </span>",'<span id="demoDob">Loading...</span>',"</li>","<li><span>MRN: </span>",'<span id="demoMrn">Loading...</span>',"</li></ul>",'<ul class="demo-itms">','<li id="demoSex">Sex:',"</li>","<li><span>FIN: </span>",'<span id="demoFin">Loading...</span>',"</li></ul>",'<ul class="demo-itms">',"<li><span>Location: </span>",'<span id="demoLoc">Loading...</span>',"</li>","<li>&nbsp;</li></ul>",'<a id="reachClose"></a>',"</div>"),$("body").prepend(f.join("")),$("body").addClass("in-iframe"),$("#demoName").text(i);var l=$("#demoSex").html();$("#demoSex").html(l+" "+k),MP_Core.XMLCCLRequestCallBack(null,e,ReachSummaryMPage.buildDemoHTML)},ReachSummaryMPage.prototype.initializeComponents=function(){var a=null;MPageView.prototype.initializeComponents.call(this,null),this.banner=!1,a=this.getCriterion(),MD_xrPrintDialog.setCriterion(a)},ReachSummaryMPage.prototype.loadPrintMenuItem=function(){var a=null;return this.getXRPrintFlag()&&(a=new MenuSelection("printMenu"+this.getCategoryMean()),a.setLabel(i18n.discernabu.CREATE_REPORT),a.setClickFunction(function(){MD_xrPrintDialog.initializeModalObject()})),a},ReachSummaryMPage.prototype.loadLogoutMenuItem=function(){var a=null;return a=new MenuSelection("logoutMenu"+this.getCategoryMean()),a.setLabel(i18n.discernabu.LOGOUT),a.setClickFunction(function(){parent.MPM.wf.closeIframe()}),a},ReachSummaryMPage.prototype.loadHelpMenuItem=function(){var a=null;return a=new MenuSelection("helpMenu"+this.getCategoryMean()),a.setLabel(i18n.discernabu.HELP),a.setClickFunction(function(){window.open("https://wiki.ucern.com/display/r1mpagesHP/MPages+Help+Pages")}),a},ReachSummaryMPage.prototype.createClearPrefsMenuItem=function(){var a=this,b=new MenuSelection("clearPrefs"+a.getCategoryMean());return b.setLabel(i18n.discernabu.CLEAR_PREFERENCES),b.setCloseOnClick(!0),b.setClickFunction(function(){var b=i18n.discernabu.CLEAR_ALL_PREFS+"<br />"+i18n.discernabu.CLEAR_ALL_PREFS_CANCEL;MP_Util.AlertConfirm(b,i18n.discernabu.CLEAR_PREFERENCES,i18n.discernabu.CONFIRM_CLEAR,i18n.discernabu.CONFIRM_CANCEL,!0,function(){var b=new ScriptRequest;b.setProgramName("MP_MAINTAIN_USER_PREFS"),b.setParameterArray(["^mine^",a.getCriterion().provider_id+".0","^"+a.getCategoryMean()+"^","~~"]),b.setAsyncIndicator(!1),b.setResponseHandler(function(a){"F"===a.getStatus()&&logger.logError(a.getError())}),b.performRequest(),CERN_Platform.refreshMPage()})}),b},ReachSummaryMPage.prototype.loadPageMenu=function(){var a=this.getCategoryMean(),b=null;MPageView.prototype.loadPageMenu.call(this);var c=MP_MenuManager.getMenuObject("pageMenu"+a);b=this.loadPrintMenuItem(),MenuItem.prototype.isPrototypeOf(b)&&c.insertMenuItem(b,5),c.insertMenuItem(new MenuSeparator("separator"),6),b=this.loadLogoutMenuItem(),MenuItem.prototype.isPrototypeOf(b)&&c.insertMenuItem(b,7),MP_MenuManager.updateMenuObject(c),$("#pageMenuMP_REACH_V5").addClass("demo-page-menu")},ReachSummaryMPage.buildDemoHTML=function(a){var b,c,d,e,f=a.getResponse(),g="",h="",i="",j=new Date,k="",l=null,m=null,n=null,o=null,p=[],q=[],r=null;if(r=MP_Util.LoadCodeListJSON(f.CODES),o=f.DEMOGRAPHICS.PATIENT_INFO,""!==o.ABS_BIRTH_DT_TM){var s="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",t=o.ABS_BIRTH_DT_TM.match(new RegExp(s));j=new Date(t[1],t[3]-1,t[5],t[7],t[8],t[10]),i=j.format("shortDate2")}else""!==o.BIRTH_DT_TM&&(j.setISO8601(o.BIRTH_DT_TM),i=j.format("shortDate2"));i?$("#demoDob").html(i):$("#demoDob").html("--");var u=f.DEMOGRAPHICS.ENCOUNTER_INFO;for(d=0,b=u.length;d<b;d++)for(l=MP_Util.GetValueFromArray(u[d].LOC_NURSE_UNIT_CD,r),m=MP_Util.GetValueFromArray(u[d].LOC_ROOM_CD,r),n=MP_Util.GetValueFromArray(u[d].LOC_BED_CD,r),l&&(k+=l?l.description:""),m&&(k+=m?"; "+m.description:""),n&&(k+=n?"; "+n.description:""),""===k&&(k="--"),c=0,e=u[d].ALIAS.length;c<e;c++)p[c]=MP_Util.GetValueFromArray(u[d].ALIAS[c].ALIAS_TYPE_CD,r),"FIN NBR"===p[c].meaning?h=u[d].ALIAS[c].FORMATTED_ALIAS:"MRN"===p[c].meaning&&(g=u[d].ALIAS[c].FORMATTED_ALIAS);if($("#demoLoc").html(k),""===g){var v=f.DEMOGRAPHICS.PATIENT_INFO.ALIAS;for(c=0,e=v.length;c<e;c++)q[c]=MP_Util.GetValueFromArray(v[c].ALIAS_TYPE_CD,r),"MRN"===q[c].meaning&&(g=v[c].FORMATTED_ALIAS)}$("#demoMrn").html(g||"--"),$("#demoFin").html(h||"--"),$("#reachLoad").removeClass("demo-load"),$("#reachScreen").removeClass("demo-screen"),$("#reachClose").click(function(){$("html",parent.document).removeClass("reach-hide-scroll"),$("#reach1",parent.document).remove()})},ReachSummaryMPage.prototype.renderView=function(){var a=MP_Util.CreateTimer("ENG:MPG.MPageReachView - renderMPage",this.getCategoryMean()),b=null,c=null,d=0,e=[],f=null,g=[],h=0,i=0;try{if(!this.isContextValid())return this.displayInvalidContextMessage(),!1;var j=this.createAggregateTimer();if(j.markTimerStarted(),this.setContainer($(document.body)),c=this.getComponents(),!c||!c.length)throw new Error(i18n.VIEW_SETTINGS_UNAVAILABLE);return d=c.length,MP_Util.Doc.AddPageTitle(this.getName(),this.getContainer(),this.getCriterion().debug_ind,this.getCustomizeEnabled(),this.getTitleAnchors(),this.getHelpFileName(),this.getHelpFileURL(),this.getCriterion(),null),this.renderComponents(c),c=MP_Util.GetComponentArray(c),this.loadPageMenu(),MP_Util.Doc.AddCustomizeLink(this.getCriterion()),MP_Util.Doc.SetupExpandCollapse(this.getCategoryMean()),MP_Util.Doc.SetupCompFilters(this.getComponents()),MP_Util.Doc.CreateCompMenus(this.getComponents(),!1),i=c.length,window.setTimeout(function(){var a=0,k=0,l=0,m=0;for(k=0;k<i;k++){e[k]={},e[k].ROWS=[],f=c[k];var n=f.length;for(l=0;l<n;l++){var o=f[l];for(h=o.length,m=0;m<h;m++)b=o[m],e[k].ROWS[m]||(e[k].ROWS[m]=[]),b.isDisplayable()&&b.isExpanded()&&!b.isLoaded()?e[k].ROWS[m].push(b):!b.isDisplayable()||b.isExpanded()||b.isLoaded()||g.push(b)}}for(k=0;k<i;k++)for(f=e[k],h=f.ROWS.length,l=0;l<h;l++){var p=f.ROWS[l],q=p.length;for(m=0;m<q;m++)b=p[m],b.setLoaded(!0),j.registerTask(b.getStyles().getId()),b.setAggregateTimer(j),a++,b.startComponentDataRetrieval()}for(k=0;k<g.length;k++)b=g[k],b.setLoaded(!0),j.registerTask(b.getStyles().getId()),b.setAggregateTimer(j),a++,b.startComponentDataRetrieval();j.addMetaData("component.count",d),j.addMetaData("component.initialLoadCount",a),j.lockRegistration()},0),!0}catch(b){throw a&&(a.Abort(),a=null),logger.logJSError(b,null,"mpages-reach.js","renderView"),b}finally{a&&a.Stop()}};